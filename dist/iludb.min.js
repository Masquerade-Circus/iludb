!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.IluDB=r()}(this,function(){"use strict";var e=function(t){return void 0===t};var n=function(t,r){for(var e=-1,n=null==t?0:t.length,o=0,a=[];++e<n;){var u=t[e];r(u,e,t)&&(a[o++]=u)}return a};var o=function(c){return function(t,r,e){for(var n=-1,o=Object(t),a=e(t),u=a.length;u--;){var i=a[c?u:++n];if(!1===r(o[i],i,o))break}return t}}();var v=function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n},t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t,r){return t(r={exports:{}},r.exports),r.exports}var u="object"==typeof t&&t&&t.Object===Object&&t,a="object"==typeof self&&self&&self.Object===Object&&self,i=u||a||Function("return this")(),c=i.Symbol,f=Object.prototype,s=f.hasOwnProperty,l=f.toString,p=c?c.toStringTag:void 0;var d=function(t){var r=s.call(t,p),e=t[p];try{t[p]=void 0}catch(t){}var n=l.call(t);return r?t[p]=e:delete t[p],n},b=Object.prototype.toString;var h=function(t){return b.call(t)},y=c?c.toStringTag:void 0;var j=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":y&&y in Object(t)?d(t):h(t)};var g=function(t){return null!=t&&"object"==typeof t};var _=function(t){return g(t)&&"[object Arguments]"==j(t)},w=Object.prototype,O=w.hasOwnProperty,A=w.propertyIsEnumerable,m=_(function(){return arguments}())?_:function(t){return g(t)&&O.call(t,"callee")&&!A.call(t,"callee")},x=Array.isArray;var $=function(){return!1},S=r(function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e?i.Buffer:void 0;t.exports=(o?o.isBuffer:void 0)||$}),z=/^(?:0|[1-9]\d*)$/;var D=function(t,r){var e=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==e||"symbol"!=e&&z.test(t))&&-1<t&&t%1==0&&t<r};var E=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991},P={};P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Arguments]"]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object Boolean]"]=P["[object DataView]"]=P["[object Date]"]=P["[object Error]"]=P["[object Function]"]=P["[object Map]"]=P["[object Number]"]=P["[object Object]"]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object WeakMap]"]=!1;var I=function(t){return g(t)&&E(t.length)&&!!P[j(t)]};var k=function(r){return function(t){return r(t)}},T=r(function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e&&u.process,a=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=a}),F=T&&T.isTypedArray,M=F?k(F):I,U=Object.prototype.hasOwnProperty;var B=function(t,r){var e=x(t),n=!e&&m(t),o=!e&&!n&&S(t),a=!e&&!n&&!o&&M(t),u=e||n||o||a,i=u?v(t.length,String):[],c=i.length;for(var f in t)!r&&!U.call(t,f)||u&&("length"==f||o&&("offset"==f||"parent"==f)||a&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||D(f,c))||i.push(f);return i},C=Object.prototype;var N=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||C)};var L=function(r,e){return function(t){return r(e(t))}},R=L(Object.keys,Object),V=Object.prototype.hasOwnProperty;var W=function(t){if(!N(t))return R(t);var r=[];for(var e in Object(t))V.call(t,e)&&"constructor"!=e&&r.push(e);return r};var q=function(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)};var G=function(t){if(!q(t))return!1;var r=j(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r};var H=function(t){return null!=t&&E(t.length)&&!G(t)};var J=function(t){return H(t)?B(t):W(t)};var K=function(a,u){return function(t,r){if(null==t)return t;if(!H(t))return a(t,r);for(var e=t.length,n=u?e:-1,o=Object(t);(u?n--:++n<e)&&!1!==r(o[n],n,o););return t}}(function(t,r){return t&&o(t,r,J)});var Q=function(t,n){var o=[];return K(t,function(t,r,e){n(t,r,e)&&o.push(t)}),o};var X=function(t,r){return t===r||t!=t&&r!=r};var Y=function(t,r){for(var e=t.length;e--;)if(X(t[e][0],r))return e;return-1},Z=Array.prototype.splice;var tt=function(t){var r=this.__data__,e=Y(r,t);return!(e<0||(e==r.length-1?r.pop():Z.call(r,e,1),--this.size,0))};var rt=function(t){var r=this.__data__,e=Y(r,t);return e<0?void 0:r[e][1]};var et=function(t){return-1<Y(this.__data__,t)};var nt=function(t,r){var e=this.__data__,n=Y(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};function ot(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ot.prototype.clear=function(){this.__data__=[],this.size=0},ot.prototype.delete=tt,ot.prototype.get=rt,ot.prototype.has=et,ot.prototype.set=nt;var at=ot;var ut=function(){this.__data__=new at,this.size=0};var it=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e};var ct=function(t){return this.__data__.get(t)};var ft,vt=function(t){return this.__data__.has(t)},st=i["__core-js_shared__"],lt=(ft=/[^.]+$/.exec(st&&st.keys&&st.keys.IE_PROTO||""))?"Symbol(src)_1."+ft:"";var pt=function(t){return!!lt&&lt in t},dt=Function.prototype.toString;var bt=function(t){if(null!=t){try{return dt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},ht=/^\[object .+?Constructor\]$/,yt=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var jt=function(t){return!(!q(t)||pt(t))&&(G(t)?yt:ht).test(bt(t))};var gt=function(t,r){return null==t?void 0:t[r]};var _t=function(t,r){var e=gt(t,r);return jt(e)?e:void 0},wt=_t(i,"Map"),Ot=_t(Object,"create");var At=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},mt=Object.prototype.hasOwnProperty;var xt=function(t){var r=this.__data__;if(Ot){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return mt.call(r,t)?r[t]:void 0},$t=Object.prototype.hasOwnProperty;var St=function(t){var r=this.__data__;return Ot?void 0!==r[t]:$t.call(r,t)};var zt=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=Ot&&void 0===r?"__lodash_hash_undefined__":r,this};function Dt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Dt.prototype.clear=function(){this.__data__=Ot?Ot(null):{},this.size=0},Dt.prototype.delete=At,Dt.prototype.get=xt,Dt.prototype.has=St,Dt.prototype.set=zt;var Et=Dt;var Pt=function(t){var r=typeof t;return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t};var It=function(t,r){var e=t.__data__;return Pt(r)?e["string"==typeof r?"string":"hash"]:e.map};var kt=function(t){var r=It(this,t).delete(t);return this.size-=r?1:0,r};var Tt=function(t){return It(this,t).get(t)};var Ft=function(t){return It(this,t).has(t)};var Mt=function(t,r){var e=It(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function Ut(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Ut.prototype.clear=function(){this.size=0,this.__data__={hash:new Et,map:new(wt||at),string:new Et}},Ut.prototype.delete=kt,Ut.prototype.get=Tt,Ut.prototype.has=Ft,Ut.prototype.set=Mt;var Bt=Ut;var Ct=function(t,r){var e=this.__data__;if(e instanceof at){var n=e.__data__;if(!wt||n.length<199)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new Bt(n)}return e.set(t,r),this.size=e.size,this};function Nt(t){var r=this.__data__=new at(t);this.size=r.size}Nt.prototype.clear=ut,Nt.prototype.delete=it,Nt.prototype.get=ct,Nt.prototype.has=vt,Nt.prototype.set=Ct;var Lt=Nt;var Rt=function(t){return this.__data__.has(t)};function Vt(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new Bt;++r<e;)this.add(t[r])}Vt.prototype.add=Vt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Vt.prototype.has=Rt;var Wt=Vt;var qt=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1};var Gt=function(t,r){return t.has(r)};var Ht=function(t,r,e,n,o,a){var u=1&e,i=t.length,c=r.length;if(i!=c&&!(u&&i<c))return!1;var f=a.get(t);if(f&&a.get(r))return f==r;var v=-1,s=!0,l=2&e?new Wt:void 0;for(a.set(t,r),a.set(r,t);++v<i;){var p=t[v],d=r[v];if(n)var b=u?n(d,p,v,r,t,a):n(p,d,v,t,r,a);if(void 0!==b){if(b)continue;s=!1;break}if(l){if(!qt(r,function(t,r){if(!Gt(l,r)&&(p===t||o(p,t,e,n,a)))return l.push(r)})){s=!1;break}}else if(p!==d&&!o(p,d,e,n,a)){s=!1;break}}return a.delete(t),a.delete(r),s},Jt=i.Uint8Array;var Kt=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n};var Qt=function(t){var r=-1,e=Array(t.size);return t.forEach(function(t){e[++r]=t}),e},Xt=c?c.prototype:void 0,Yt=Xt?Xt.valueOf:void 0;var Zt=function(t,r,e,n,o,a,u){switch(e){case"[object DataView]":if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=r.byteLength||!a(new Jt(t),new Jt(r)));case"[object Boolean]":case"[object Date]":case"[object Number]":return X(+t,+r);case"[object Error]":return t.name==r.name&&t.message==r.message;case"[object RegExp]":case"[object String]":return t==r+"";case"[object Map]":var i=Kt;case"[object Set]":if(i||(i=Qt),t.size!=r.size&&!(1&n))return!1;var c=u.get(t);if(c)return c==r;n|=2,u.set(t,r);var f=Ht(i(t),i(r),n,o,a,u);return u.delete(t),f;case"[object Symbol]":if(Yt)return Yt.call(t)==Yt.call(r)}return!1};var tr=function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t};var rr=function(t,r,e){var n=r(t);return x(t)?n:tr(n,e(t))};var er=function(){return[]},nr=Object.prototype.propertyIsEnumerable,or=Object.getOwnPropertySymbols,ar=or?function(r){return null==r?[]:n(or(r=Object(r)),function(t){return nr.call(r,t)})}:er;var ur=function(t){return rr(t,J,ar)},ir=Object.prototype.hasOwnProperty;var cr=function(t,r,e,n,o,a){var u=1&e,i=ur(t),c=i.length;if(c!=ur(r).length&&!u)return!1;for(var f=c;f--;){var v=i[f];if(!(u?v in r:ir.call(r,v)))return!1}var s=a.get(t);if(s&&a.get(r))return s==r;var l=!0;a.set(t,r),a.set(r,t);for(var p=u;++f<c;){var d=t[v=i[f]],b=r[v];if(n)var h=u?n(b,d,v,r,t,a):n(d,b,v,t,r,a);if(!(void 0===h?d===b||o(d,b,e,n,a):h)){l=!1;break}p||(p="constructor"==v)}if(l&&!p){var y=t.constructor,j=r.constructor;y!=j&&"constructor"in t&&"constructor"in r&&!("function"==typeof y&&y instanceof y&&"function"==typeof j&&j instanceof j)&&(l=!1)}return a.delete(t),a.delete(r),l},fr=_t(i,"DataView"),vr=_t(i,"Promise"),sr=_t(i,"Set"),lr=_t(i,"WeakMap"),pr="[object Map]",dr="[object Promise]",br="[object Set]",hr="[object WeakMap]",yr="[object DataView]",jr=bt(fr),gr=bt(wt),_r=bt(vr),wr=bt(sr),Or=bt(lr),Ar=j;(fr&&Ar(new fr(new ArrayBuffer(1)))!=yr||wt&&Ar(new wt)!=pr||vr&&Ar(vr.resolve())!=dr||sr&&Ar(new sr)!=br||lr&&Ar(new lr)!=hr)&&(Ar=function(t){var r=j(t),e="[object Object]"==r?t.constructor:void 0,n=e?bt(e):"";if(n)switch(n){case jr:return yr;case gr:return pr;case _r:return dr;case wr:return br;case Or:return hr}return r});var mr=Ar,xr="[object Arguments]",$r="[object Array]",Sr="[object Object]",zr=Object.prototype.hasOwnProperty;var Dr=function(t,r,e,n,o,a){var u=x(t),i=x(r),c=u?$r:mr(t),f=i?$r:mr(r),v=(c=c==xr?Sr:c)==Sr,s=(f=f==xr?Sr:f)==Sr,l=c==f;if(l&&S(t)){if(!S(r))return!1;v=!(u=!0)}if(l&&!v)return a||(a=new Lt),u||M(t)?Ht(t,r,e,n,o,a):Zt(t,r,c,e,n,o,a);if(!(1&e)){var p=v&&zr.call(t,"__wrapped__"),d=s&&zr.call(r,"__wrapped__");if(p||d){var b=p?t.value():t,h=d?r.value():r;return a||(a=new Lt),o(b,h,e,n,a)}}return!!l&&(a||(a=new Lt),cr(t,r,e,n,o,a))};var Er=function t(r,e,n,o,a){return r===e||(null==r||null==e||!g(r)&&!g(e)?r!=r&&e!=e:Dr(r,e,n,o,t,a))};var Pr=function(t,r,e,n){var o=e.length,a=o,u=!n;if(null==t)return!a;for(t=Object(t);o--;){var i=e[o];if(u&&i[2]?i[1]!==t[i[0]]:!(i[0]in t))return!1}for(;++o<a;){var c=(i=e[o])[0],f=t[c],v=i[1];if(u&&i[2]){if(void 0===f&&!(c in t))return!1}else{var s=new Lt;if(n)var l=n(f,v,c,t,r,s);if(!(void 0===l?Er(v,f,3,n,s):l))return!1}}return!0};var Ir=function(t){return t==t&&!q(t)};var kr=function(t){for(var r=J(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,Ir(o)]}return r};var Tr=function(r,e){return function(t){return null!=t&&t[r]===e&&(void 0!==e||r in Object(t))}};var Fr=function(r){var e=kr(r);return 1==e.length&&e[0][2]?Tr(e[0][0],e[0][1]):function(t){return t===r||Pr(t,r,e)}};var Mr=function(t){return"symbol"==typeof t||g(t)&&"[object Symbol]"==j(t)},Ur=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Br=/^\w*$/;var Cr=function(t,r){if(x(t))return!1;var e=typeof t;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!Mr(t))||Br.test(t)||!Ur.test(t)||null!=r&&t in Object(r)},Nr="Expected a function";function Lr(o,a){if("function"!=typeof o||null!=a&&"function"!=typeof a)throw new TypeError(Nr);var u=function(){var t=arguments,r=a?a.apply(this,t):t[0],e=u.cache;if(e.has(r))return e.get(r);var n=o.apply(this,t);return u.cache=e.set(r,n)||e,n};return u.cache=new(Lr.Cache||Bt),u}Lr.Cache=Bt;var Rr=Lr;var Vr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Wr=/\\(\\)?/g,qr=function(t){var r=Rr(t,function(t){return 500===e.size&&e.clear(),t}),e=r.cache;return r}(function(t){var o=[];return 46==t.charCodeAt(0)&&o.push(""),t.replace(Vr,function(t,r,e,n){o.push(e?n.replace(Wr,"$1"):r||t)}),o});var Gr=function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o},Hr=1/0,Jr=c?c.prototype:void 0,Kr=Jr?Jr.toString:void 0;var Qr=function t(r){if("string"==typeof r)return r;if(x(r))return Gr(r,t)+"";if(Mr(r))return Kr?Kr.call(r):"";var e=r+"";return"0"==e&&1/r==-Hr?"-0":e};var Xr=function(t){return null==t?"":Qr(t)};var Yr=function(t,r){return x(t)?t:Cr(t,r)?[t]:qr(Xr(t))};var Zr=function(t){if("string"==typeof t||Mr(t))return t;var r=t+"";return"0"==r&&1/t==-1/0?"-0":r};var te=function(t,r){for(var e=0,n=(r=Yr(r,t)).length;null!=t&&e<n;)t=t[Zr(r[e++])];return e&&e==n?t:void 0};var re=function(t,r,e){var n=null==t?void 0:te(t,r);return void 0===n?e:n};var ee=function(t,r){return null!=t&&r in Object(t)};var ne=function(t,r,e){for(var n=-1,o=(r=Yr(r,t)).length,a=!1;++n<o;){var u=Zr(r[n]);if(!(a=null!=t&&e(t,u)))break;t=t[u]}return a||++n!=o?a:!!(o=null==t?0:t.length)&&E(o)&&D(u,o)&&(x(t)||m(t))};var oe=function(t,r){return null!=t&&ne(t,r,ee)};var ae=function(e,n){return Cr(e)&&Ir(n)?Tr(Zr(e),n):function(t){var r=re(t,e);return void 0===r&&r===n?oe(t,e):Er(n,r,3)}};var ue=function(t){return t};var ie=function(r){return function(t){return null==t?void 0:t[r]}};var ce=function(r){return function(t){return te(t,r)}};var fe=function(t){return Cr(t)?ie(Zr(t)):ce(t)};var ve=function(t){return"function"==typeof t?t:null==t?ue:"object"==typeof t?x(t)?ae(t[0],t[1]):Fr(t):fe(t)};var se=function(t,r){return(x(t)?n:Q)(t,ve(r,3))};var le=function(t,r,e,n){for(var o=t.length,a=e+(n?1:-1);n?a--:++a<o;)if(r(t[a],a,t))return a;return-1},pe=/^\s+|\s+$/g,de=/^[-+]0x[0-9a-f]+$/i,be=/^0b[01]+$/i,he=/^0o[0-7]+$/i,ye=parseInt;var je=function(t){if("number"==typeof t)return t;if(Mr(t))return NaN;if(q(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=q(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(pe,"");var e=be.test(t);return e||he.test(t)?ye(t.slice(2),e?2:8):de.test(t)?NaN:+t};var ge=function(t){return t?(t=je(t))!==1/0&&t!==-1/0?t==t?t:0:17976931348623157e292*(t<0?-1:1):0===t?t:0};var _e=function(t){var r=ge(t),e=r%1;return r==r?e?r-e:r:0},we=Math.max;var Oe=function(t,r,e){var n=null==t?0:t.length;if(!n)return-1;var o=null==e?0:_e(e);return o<0&&(o=we(n+o,0)),le(t,ve(r,3),o)},Ae=function(u){return function(t,r,e){var n=Object(t);if(!H(t)){var o=ve(r,3);t=J(t),r=function(t){return o(n[t],t,n)}}var a=u(t,r,e);return-1<a?n[o?t[a]:a]:void 0}}(Oe);var me=function(t,n){var o=-1,a=H(t)?Array(t.length):[];return K(t,function(t,r,e){a[++o]=n(t,r,e)}),a};var xe=function(t,r){var e=t.length;for(t.sort(r);e--;)t[e]=t[e].value;return t};var $e=function(t,r){if(t!==r){var e=void 0!==t,n=null===t,o=t==t,a=Mr(t),u=void 0!==r,i=null===r,c=r==r,f=Mr(r);if(!i&&!f&&!a&&r<t||a&&u&&c&&!i&&!f||n&&u&&c||!e&&c||!o)return 1;if(!n&&!a&&!f&&t<r||f&&e&&o&&!n&&!a||i&&e&&o||!u&&o||!c)return-1}return 0};var Se=function(t,r,e){for(var n=-1,o=t.criteria,a=r.criteria,u=o.length,i=e.length;++n<u;){var c=$e(o[n],a[n]);if(c)return i<=n?c:c*("desc"==e[n]?-1:1)}return t.index-r.index};var ze=function(t,n,e){var o=-1;n=Gr(n.length?n:[ue],k(ve));var r=me(t,function(r,t,e){return{criteria:Gr(n,function(t){return t(r)}),index:++o,value:r}});return xe(r,function(t,r){return Se(t,r,e)})};var De=function(t,r,e,n){return null==t?[]:(x(r)||(r=null==r?[]:[r]),x(e=n?void 0:e)||(e=null==e?[]:[e]),ze(t,r,e))};var Ee=function(t){return"string"==typeof t||!x(t)&&g(t)&&"[object String]"==j(t)},Pe=ie("length"),Ie=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff\ufe0e\ufe0f]/;var ke=function(t){return Ie.test(t)},Te="\\ud800-\\udfff",Fe="["+Te+"]",Me="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ue="\\ud83c[\\udffb-\\udfff]",Be="[^"+Te+"]",Ce="(?:\\ud83c[\\udde6-\\uddff]){2}",Ne="[\\ud800-\\udbff][\\udc00-\\udfff]",Le="(?:"+Me+"|"+Ue+")"+"?",Re="[\\ufe0e\\ufe0f]?",Ve=Re+Le+("(?:\\u200d(?:"+[Be,Ce,Ne].join("|")+")"+Re+Le+")*"),We=RegExp(Ue+"(?="+Ue+")|"+("(?:"+[Be+Me+"?",Me,Ce,Ne,Fe].join("|")+")")+Ve,"g");var qe=function(t){for(var r=We.lastIndex=0;We.test(t);)++r;return r};var Ge=function(t){return ke(t)?qe(t):Pe(t)};var He=function(t){if(null==t)return 0;if(H(t))return Ee(t)?Ge(t):t.length;var r=mr(t);return"[object Map]"==r||"[object Set]"==r?t.size:W(t).length};var Je=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n&&!1!==r(t[e],e,t););return t},Ke=function(){try{var t=_t(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Qe=function(t,r,e){"__proto__"==r&&Ke?Ke(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e},Xe=Object.prototype.hasOwnProperty;var Ye=function(t,r,e){var n=t[r];Xe.call(t,r)&&X(n,e)&&(void 0!==e||r in t)||Qe(t,r,e)};var Ze=function(t,r,e,n){var o=!e;e||(e={});for(var a=-1,u=r.length;++a<u;){var i=r[a],c=n?n(e[i],t[i],i,e,t):void 0;void 0===c&&(c=t[i]),o?Qe(e,i,c):Ye(e,i,c)}return e};var tn=function(t,r){return t&&Ze(r,J(r),t)};var rn=function(t){var r=[];if(null!=t)for(var e in Object(t))r.push(e);return r},en=Object.prototype.hasOwnProperty;var nn=function(t){if(!q(t))return rn(t);var r=N(t),e=[];for(var n in t)("constructor"!=n||!r&&en.call(t,n))&&e.push(n);return e};var on=function(t){return H(t)?B(t,!0):nn(t)};var an=function(t,r){return t&&Ze(r,on(r),t)},un=r(function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e?i.Buffer:void 0,a=o?o.allocUnsafe:void 0;t.exports=function(t,r){if(r)return t.slice();var e=t.length,n=a?a(e):new t.constructor(e);return t.copy(n),n}});var cn=function(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r};var fn=function(t,r){return Ze(t,ar(t),r)},vn=L(Object.getPrototypeOf,Object),sn=Object.getOwnPropertySymbols?function(t){for(var r=[];t;)tr(r,ar(t)),t=vn(t);return r}:er;var ln=function(t,r){return Ze(t,sn(t),r)};var pn=function(t){return rr(t,on,sn)},dn=Object.prototype.hasOwnProperty;var bn=function(t){var r=t.length,e=new t.constructor(r);return r&&"string"==typeof t[0]&&dn.call(t,"index")&&(e.index=t.index,e.input=t.input),e};var hn=function(t){var r=new t.constructor(t.byteLength);return new Jt(r).set(new Jt(t)),r};var yn=function(t,r){var e=r?hn(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)},jn=/\w*$/;var gn=function(t){var r=new t.constructor(t.source,jn.exec(t));return r.lastIndex=t.lastIndex,r},_n=c?c.prototype:void 0,wn=_n?_n.valueOf:void 0;var On=function(t){return wn?Object(wn.call(t)):{}};var An=function(t,r){var e=r?hn(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)};var mn=function(t,r,e){var n=t.constructor;switch(r){case"[object ArrayBuffer]":return hn(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return yn(t,e);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return An(t,e);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return gn(t);case"[object Set]":return new n;case"[object Symbol]":return On(t)}},xn=Object.create,$n=function(){function e(){}return function(t){if(!q(t))return{};if(xn)return xn(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Sn=function(t){return"function"!=typeof t.constructor||N(t)?{}:$n(vn(t))};var zn=function(t){return g(t)&&"[object Map]"==mr(t)},Dn=T&&T.isMap,En=Dn?k(Dn):zn;var Pn=function(t){return g(t)&&"[object Set]"==mr(t)},In=T&&T.isSet,kn=In?k(In):Pn,Tn=1,Fn=2,Mn=4,Un="[object Arguments]",Bn="[object Function]",Cn="[object GeneratorFunction]",Nn="[object Object]",Ln={};Ln[Un]=Ln["[object Array]"]=Ln["[object ArrayBuffer]"]=Ln["[object DataView]"]=Ln["[object Boolean]"]=Ln["[object Date]"]=Ln["[object Float32Array]"]=Ln["[object Float64Array]"]=Ln["[object Int8Array]"]=Ln["[object Int16Array]"]=Ln["[object Int32Array]"]=Ln["[object Map]"]=Ln["[object Number]"]=Ln[Nn]=Ln["[object RegExp]"]=Ln["[object Set]"]=Ln["[object String]"]=Ln["[object Symbol]"]=Ln["[object Uint8Array]"]=Ln["[object Uint8ClampedArray]"]=Ln["[object Uint16Array]"]=Ln["[object Uint32Array]"]=!0,Ln["[object Error]"]=Ln[Bn]=Ln["[object WeakMap]"]=!1;var Rn=function e(n,o,a,t,r,u){var i,c=o&Tn,f=o&Fn,v=o&Mn;if(a&&(i=r?a(n,t,r,u):a(n)),void 0!==i)return i;if(!q(n))return n;var s=x(n);if(s){if(i=bn(n),!c)return cn(n,i)}else{var l=mr(n),p=l==Bn||l==Cn;if(S(n))return un(n,c);if(l==Nn||l==Un||p&&!r){if(i=f||p?{}:Sn(n),!c)return f?ln(n,an(i,n)):fn(n,tn(i,n))}else{if(!Ln[l])return r?n:{};i=mn(n,l,c)}}u||(u=new Lt);var d=u.get(n);if(d)return d;if(u.set(n,i),kn(n))return n.forEach(function(t){i.add(e(t,o,a,t,n,u))}),i;if(En(n))return n.forEach(function(t,r){i.set(r,e(t,o,a,r,n,u))}),i;var b=v?f?pn:ur:f?keysIn:J,h=s?void 0:b(n);return Je(h||n,function(t,r){h&&(t=n[r=t]),Ye(i,r,e(t,o,a,r,n,u))}),i};var Vn=function(t){return Rn(t,5)};var Wn=function(t){var r=null==t?0:t.length;return r?t[r-1]:void 0};var qn=function(t,r,e){var n=-1,o=t.length;r<0&&(r=o<-r?0:o+r),(e=o<e?o:e)<0&&(e+=o),o=e<r?0:e-r>>>0,r>>>=0;for(var a=Array(o);++n<o;)a[n]=t[n+r];return a};var Gn=function(t,r){return r.length<2?t:te(t,qn(r,0,-1))};var Hn=function(t,r){return r=Yr(r,t),null==(t=Gn(t,r))||delete t[Zr(Wn(r))]},Jn=Array.prototype.splice;var Kn=function(t,r){for(var e=t?r.length:0,n=e-1;e--;){var o=r[e];if(e==n||o!==a){var a=o;D(o)?Jn.call(t,o,1):Hn(t,o)}}return t};var Qn=function(t,r){var e=[];if(!t||!t.length)return e;var n=-1,o=[],a=t.length;for(r=ve(r,3);++n<a;){var u=t[n];r(u,n,t)&&(e.push(u),o.push(n))}return Kn(t,o),e};var Xn=function(t){return t!=t};var Yn=function(t,r,e){for(var n=e-1,o=t.length;++n<o;)if(t[n]===r)return n;return-1};var Zn=function(t,r,e){return r==r?Yn(t,r,e):le(t,Xn,e)};var to=function(r,t){return Gr(t,function(t){return r[t]})};var ro=function(t){return null==t?[]:to(t,J(t))},eo=Math.max;var no=function(t,r,e,n){t=H(t)?t:ro(t),e=e&&!n?_e(e):0;var o=t.length;return e<0&&(e=eo(o+e,0)),Ee(t)?e<=o&&-1<t.indexOf(r,e):!!o&&-1<Zn(t,r,e)};function oo(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return oo.getDatabase.apply(oo,t)}return oo.plugify=function(n){var o=[];n.use=function(t){for(var r=[],e=arguments.length-1;0<e--;)r[e]=arguments[e+1];return-1==o.indexOf(t)&&(t.apply(void 0,[n].concat(r)),o.push(t)),n}},oo.plugify(oo),oo.getDatabase=function(){var r={data:{collections:{},createdAt:new Date,modifiedAt:new Date},getCollection:function(t){return oo.getCollection(r,t)},save:function(){}};return oo.plugify(r),r},oo.getCollection=function(n,t){e(n.data.collections[t])&&(n.data.collections[t]={data:[],index:0,createdAt:new Date,modifiedAt:new Date});var o=n.data.collections[t],a={sort:function(t,r){void 0===r&&(r={});var e=t;if(0<Object.keys(r).length){var n=Object.assign({},r);for(var o in n)n[o]=1===n[o]?"asc":"desc";e=De(e,Object.keys(n),Object.values(n))}return e},find:function(t,r){void 0===t&&(t={}),void 0===r&&(r={});var e=se(o.data,t);return(e=a.sort(e,r.sort)).map(function(t){return Vn(t)})},findOne:function(t,r){void 0===t&&(t={}),void 0===r&&(r={});var e=o.data;return e=a.sort(e,r.sort),Vn(Ae(e,t))},get:function(t){return a.findOne({$id:t})},add:function(t){if("object"==typeof t&&!Array.isArray(t)&&null!==t){if(!e(t.$id))throw Error("The $id property is reserved.");if(!e(t.$createdAt))throw Error("The $createdAt property is reserved.");if(!e(t.$updatedAt))throw Error("The $updatedAt property is reserved.");return o.index+=1,t.$id=o.index,t.$createdAt=new Date,t.$modifiedAt=new Date,o.data.push(t),o.modifiedAt=new Date,n.save(),Vn(t)}},update:function(t){var r=Oe(o.data,{$id:t.$id});if(-1===r)throw Error("The document does not exists.");for(var e in t)no(["$id","$createdAt","$modifiedAt"],e)||(o.data[r][e]=t[e]);return o.data[r].$modifiedAt=new Date,o.modifiedAt=new Date,n.save(),Vn(o.data[r])},remove:function(t){var r=a.findOne({$id:t.$id});if(e(r))throw Error("The document does not exists.");Qn(o.data,{$id:t.$id}),o.modifiedAt=new Date,n.save()},count:function(t){return void 0===t&&(t={}),He(a.find(t))}};return oo.plugify(a),a},oo});
